<ion-content class="dashboard-page">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-top">
      <h1>Shop Owner</h1>
      <ion-button fill="clear" size="small" class="login-button" (click)="goToLogin()">
        <ion-icon name="log-out-outline"></ion-icon>
      </ion-button>
    </div>

    <!-- Shop Card -->
    <ion-card class="shop-card">
      <div class="shop-card-content">
        <div class="shop-avatar">
          <ion-avatar>
            <span>DDA</span>
          </ion-avatar>
        </div>
        <div class="shop-info">
          <h2>Desi Darbar - Amritsar</h2>
          <p>Open • 9:00 AM - 10:00 PM</p>
        </div>
        <ion-button fill="clear" size="small" (click)="editShop()">
          <ion-icon name="pencil-outline"></ion-icon>
          Edit
        </ion-button>
      </div>

      <!-- Shop Stats -->
      <div class="shop-stats">
        <ion-card class="stat-card">
          <div class="stat-content">
            <div class="stat-value">456</div>
            <div class="stat-label">Today's nearby views</div>
            <div class="stat-change">+18% vs yesterday</div>
          </div>
        </ion-card>
        <ion-card class="stat-card">
          <div class="stat-content">
            <div class="stat-value">42</div>
            <div class="stat-label">Favorites added</div>
            <div class="stat-detail">Top item: Amritsari Kulcha</div>
          </div>
        </ion-card>
        <ion-card class="stat-card">
          <div class="stat-content">
            <div class="stat-value">1.2 Km avg</div>
            <div class="stat-label">discovery</div>
            <div class="stat-detail">Local reach this week</div>
          </div>
        </ion-card>
        <ion-card class="stat-card">
          <div class="stat-content">
            <div class="stat-value">8.5k</div>
            <div class="stat-label">impressions</div>
            <div class="stat-detail">Reached this month</div>
          </div>
        </ion-card>
      </div>
    </ion-card>

    <!-- Recent Reviews -->
    <div class="recent-section">
      <h3>Recent reviews</h3>
      <ion-card class="review-card" *ngFor="let review of recentReviews">
        <div class="review-header">
          <ion-avatar class="review-avatar">
            <img [src]="review.avatar" [alt]="review.name">
          </ion-avatar>
          <div class="review-user">
            <h4>{{ review.name }}</h4>
            <div class="rating">
              <ion-icon name="star" color="warning" *ngFor="let i of [1,2,3,4,5]"></ion-icon>
            </div>
          </div>
        </div>
        <p class="review-text">{{ review.text }}</p>
      </ion-card>
    </div>
  </div>

  <!-- Quick Actions (Sticky at bottom) -->
  <div class="quick-actions">
    <h3>Quick actions</h3>
    <div class="action-buttons">
      <ion-button fill="outline" expand="block" (click)="addProduct()">
        <ion-icon slot="start" name="add-circle-outline"></ion-icon>
        Add product
      </ion-button>
      <ion-button fill="outline" expand="block" (click)="updateHours()">
        <ion-icon slot="start" name="time-outline"></ion-icon>
        Update hours
      </ion-button>
      <ion-button fill="outline" expand="block" (click)="editLocation()">
        <ion-icon slot="start" name="location-outline"></ion-icon>
        Edit location
      </ion-button>
    </div>
  </div>

  <!-- Today at a Glance -->
  <div class="today-section">
    <h3>Today at a glance</h3>
    <ion-list lines="none" class="glance-list">
      <ion-item>
        <ion-label>Open status</ion-label>
        <ion-badge slot="end" color="success">Open</ion-badge>
      </ion-item>
      <ion-item>
        <ion-label>Next peak window</ion-label>
        <ion-text slot="end">8:30 - 10:30 AM</ion-text>
      </ion-item>
      
    </ion-list>
  </div>
</ion-content>

<!-- Update Hours Modal -->
<ion-modal [isOpen]="isHoursModalOpen" (didDismiss)="closeHoursModal()">
  <ng-template>
    <ion-header class="modal-header">
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button (click)="closeHoursModal()">
            <ion-icon name="chevron-back-outline"></ion-icon>
          </ion-button>
        </ion-buttons>
        <ion-title>Update Hours</ion-title>
        <ion-buttons slot="end">
          <span class="local-time-text">Local time</span>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content class="hours-modal-content">
      <!-- Breadcrumb -->
      <div class="modal-breadcrumb">Shop Profile • Availability</div>

      <!-- General Section -->
      <div class="modal-section general-section">
        <h4 class="section-heading">General</h4>
        
        <div class="general-item">
          <div class="item-left">
            <ion-icon name="settings-outline"></ion-icon>
            <span>Use shop timezone</span>
          </div>
          <ion-toggle [(ngModel)]="useShopTimezone" ></ion-toggle>
        </div>

        <div class="general-item">
          <div class="item-left">
            <ion-icon name="calendar-outline"></ion-icon>
            <span>Special dates and holidays</span>
          </div>
        </div>
      </div>

      <!-- Weekly Hours Section -->
      <div class="modal-section weekly-section">
        <h4 class="section-heading">Weekly hours</h4>
        
        <div class="hours-list">
          <div class="day-row" *ngFor="let day of weeklyHours">
            <div class="day-name">{{ day.name }}</div>

            <div class="time-row" *ngIf="!day.closed">
              <div class="time-box">
                <span class="time-value">{{ formatTime(day.opening) }}</span>
                <ion-icon name="time-outline" class="time-icon"></ion-icon>
              </div>

              <span class="time-separator">to</span>

              <div class="time-box">
                <span class="time-value">{{ formatTime(day.closing) }}</span>
                <ion-icon name="time-outline" class="time-icon"></ion-icon>
              </div>
            </div>

            <div class="closed-row" *ngIf="day.closed">
              <span class="closed-text">Closed</span>
              <ion-button fill="clear" size="small" (click)="toggleDayStatus(day)" class="open-btn">
                OPEN
              </ion-button>
            </div>
          </div>
        </div>
      </div>

      <!-- Notes for Visitors Section -->
      <div class="modal-section notes-section">
        <h4 class="section-heading">Notes For Visitors</h4>

        <div class="checkbox-item">
          <ion-checkbox [(ngModel)]="showNotesCheckbox"></ion-checkbox>
          <label>Add an optional note (e.g., Closed on public holidays)</label>
        </div>

        <ion-textarea 
          *ngIf="showNotesCheckbox"
          [(ngModel)]="visitorNotes"
          placeholder="Enter note for customers..."
          class="visitor-textarea">
        </ion-textarea>
      </div>

      <!-- Info Message -->
      <div class="info-banner">
        <ion-icon name="information-circle-outline"></ion-icon>
        <p>Changes shown in the Customer App and affect "Open now" status.</p>
      </div>
    </ion-content>

    <!-- Footer with Actions -->
    <ion-footer class="modal-footer">
      <div class="footer-button-group">
        <ion-button fill="outline" expand="block" (click)="closeHoursModal()" class="discard-btn">
          <ion-icon name="close-outline" slot="start"></ion-icon>
          DISCARD
        </ion-button>
        <ion-button fill="solid" expand="block"  (click)="saveHours()" class="save-btn">
          <ion-icon name="checkmark-outline" slot="start"></ion-icon>
          SAVE HOURS
        </ion-button>
      </div>
    </ion-footer>
  </ng-template>
</ion-modal>
