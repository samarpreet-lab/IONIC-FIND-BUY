<ion-content class="shop-profile-page">
  <!-- Header with Top Actions -->
  <div class="profile-header">
    <div class="header-top">
      <div class="header-left">
        <ion-menu-button></ion-menu-button>
        <span class="label">Shop Profile</span>
        
      </div>
      <div class="header-actions">
        <ion-button fill="solid" class="save-btn" (click)="saveProfile()">
          <ion-icon slot="start" name="checkmark"></ion-icon>
          Save
        </ion-button>
      </div>
    </div>

    <!-- Tabs Navigation -->
    <div class="segment-wrapper">
      <ion-segment [value]="activeTab" (ionChange)="setActiveTab($event)">
        <ion-segment-button value="basic">
          <ion-label>Basic Info</ion-label>
        </ion-segment-button>
        <ion-segment-button value="location">
          <ion-label>Location</ion-label>
        </ion-segment-button>
        <ion-segment-button value="photos">
          <ion-label>Photos</ion-label>
        </ion-segment-button>
      </ion-segment>
    </div>
  </div>

  <!-- Tab 1: Basic Info -->
  <div class="tab-content basic-info" *ngIf="activeTab === 'basic'">
    <!-- Shop Info Card -->
    <div class="shop-info-card">
      <div class="shop-avatar">
        <img [src]="shopProfile.avatar" [alt]="shopProfile.name">
      </div>
      <div class="shop-details">
        <h2 class="shop-name">{{ shopProfile.name }}</h2>
        <p class="shop-type">{{ shopProfile.type }}</p>
        <p class="shop-since">Since {{ shopProfile.since }}</p>
        <ion-button fill="clear" class="change-logo-btn">
          <ion-icon slot="start" name="pencil-outline"></ion-icon>
          Change logo
        </ion-button>
      </div>
    </div>

    <!-- Shop Name Input -->
    <div class="form-group">
      <label>Shop name</label>
      <input type="text" class="form-input" [(ngModel)]="shopProfile.name">
    </div>

    <!-- Description Input -->
    <div class="form-group">
      <label>Description</label>
      <textarea class="form-textarea" [(ngModel)]="shopProfile.description"></textarea>
    </div>

    <!-- Contact Row -->
    <div class="form-group form-row">
      <div class="form-col">
        <label>Phone</label>
        <input type="tel" class="form-input" [(ngModel)]="shopProfile.phone">
      </div>
      <div class="form-col">
        <label>Email</label>
        <input type="email" class="form-input" [(ngModel)]="shopProfile.email">
      </div>
    </div>

    <!-- Hours Input -->
    <div class="form-group">
      <label>Opening hours</label>
      <div class="hours-display-card">
        <div class="hours-row">
          <span class="hours-label">Today</span>
          <span class="hours-value">{{ getTodayHours() }}</span>
        </div>
        <div class="hours-row">
          <span class="hours-label">Sample</span>
          <span class="hours-value">{{ getFirstOpeningHour() }}</span>
        </div>
        <div class="hours-schedule">
          <div class="schedule-item" *ngFor="let day of weeklyHours">
            <span class="day-name">{{ day.name }}</span>
            <span class="day-time" *ngIf="!day.closed">
              {{ formatTime(day.opening) }} - {{ formatTime(day.closing) }}
            </span>
            <span class="day-closed" *ngIf="day.closed">Closed</span>
          </div>
        </div>
      </div>
      <p class="helper-text">Update hours from Dashboard</p>
    </div>
  </div>

  <!-- Tab 2: Location -->
  <div class="tab-content location-info" *ngIf="activeTab === 'location'">
    <!-- Hours Display -->
    <div class="hours-section">
      <div class="section-label">Opening hours</div>
      <div class="section-value">{{ shopProfile.hours }}</div>
      <p class="section-hint">Keep hours accurate to help customers discover your shop.</p>
    </div>

    <!-- Location Card -->
    <div class="location-section">
      <div class="section-header">
        <span class="section-label">Location</span>
        <div class="section-actions">
          <ion-button fill="clear" size="small">
            <ion-icon name="map-outline"></ion-icon>
            View map
          </ion-button>
          <ion-button fill="solid" size="small" class="edit-btn">
            <ion-icon slot="start" name="pencil-outline"></ion-icon>
            Edit location
          </ion-button>
        </div>
      </div>

      <!-- Address Fields -->
      <div class="address-fields">
        <div class="form-row">
          <div class="form-col">
            <label>Street</label>
            <input type="text" class="form-input" [(ngModel)]="shopProfile.street">
          </div>
          <div class="form-col">
            <label>City</label>
            <input type="text" class="form-input" [(ngModel)]="shopProfile.city">
          </div>
        </div>

        <div class="form-row">
          <div class="form-col">
            <label>State/Region</label>
            <input type="text" class="form-input" [(ngModel)]="shopProfile.state">
          </div>
          <div class="form-col">
            <label>Postal code</label>
            <input type="text" class="form-input" [(ngModel)]="shopProfile.postalCode">
          </div>
        </div>

        <div class="form-row">
          <div class="form-col">
            <label>Latitude</label>
            <input type="text" class="form-input" [(ngModel)]="shopProfile.latitude">
          </div>
          <div class="form-col">
            <label>Longitude</label>
            <input type="text" class="form-input" [(ngModel)]="shopProfile.longitude">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tab 3: Photos -->
  <div class="tab-content photos-info" *ngIf="activeTab === 'photos'">
    <!-- Location Mini Card -->
    <div class="location-mini">
      <div class="mini-state">{{ shopProfile.state }}</div>
      <div class="mini-postal">{{ shopProfile.postalCode }}</div>
      <div class="mini-coords">
        <span>Latitude</span>
        <span>{{ shopProfile.latitude }}</span>
        <span>Longitude</span>
        <span>{{ shopProfile.longitude }}</span>
      </div>
    </div>

    <!-- Photo Gallery -->
    <div class="photo-gallery">
      <div class="photo-item" *ngFor="let photo of shopProfile.photos">
        <img [src]="photo" [alt]="'Shop photo'">
      </div>
    </div>

    <!-- Visibility Section -->
    <div class="visibility-section">
      <h3>Visibility</h3>
      <p class="visibility-status">{{ shopProfile.visibility }}</p>
      <p class="visibility-desc">Your shop is discoverable in the Customer App. Hide if you're temporarily closed.</p>
      
      <div class="visibility-buttons">
        <ion-button fill="clear" class="visibility-btn show-btn">
          <ion-icon name="eye-outline"></ion-icon>
          Show
        </ion-button>
        <ion-button fill="clear" class="visibility-btn hide-btn">
          <ion-icon name="eye-off-outline"></ion-icon>
          Hide
        </ion-button>
      </div>
    </div>
  </div>

  <!-- Bottom Action Buttons -->
  <div class="bottom-actions">
    <ion-button fill="outline" class="discard-btn" (click)="discardChanges()">
      <ion-icon name="close"></ion-icon>
      Discard changes
    </ion-button>
    <ion-button fill="solid" class="save-profile-btn" (click)="saveProfile()">
      <ion-icon slot="start" name="checkmark-done"></ion-icon>
      Save profile
    </ion-button>
  </div>
</ion-content>

<!-- Success Modal -->
<ion-modal [isOpen]="isSuccessModalOpen" (didDismiss)="closeSuccessModal()" class="success-modal" backdropDismiss="true">
  <ng-template>
    <div class="success-modal-inner">
      <div class="success-icon-wrapper">
        <div class="success-icon">
          <ion-icon name="checkmark-circle"></ion-icon>
        </div>
      </div>
      <h2 class="success-title">{{ successMessage }}</h2>
      <p class="success-subtitle">Your shop profile changes have been saved successfully</p>
    </div>
  </ng-template>
</ion-modal>
