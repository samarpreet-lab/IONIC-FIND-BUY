<ion-content class="products-page">
  <!-- Header -->
  <div class="header">
    <div class="header-top">
      <div class="header-left">
        <ion-menu-button></ion-menu-button>
        <span class="products-label">Products</span>
      </div>
      <div class="header-right">
        <ion-button fill="clear" size="small" class="search-button" (click)="onSearchClicked()">
          <ion-icon name="search-outline"></ion-icon>
        </ion-button>
        <ion-button fill="solid" class="add-btn" (click)="addProduct()">
          <ion-icon slot="start" name="add"></ion-icon>
          Add
        </ion-button>
      </div>
    </div>

    <!-- Search Input Section -->
    <div class="search-section" *ngIf="showSearch">
      <div class="search-input-container">
        <ion-searchbar 
          [(ngModel)]="searchTerm" 
          (ionChange)="onSearchChange()"
          placeholder="Search products..."
          debounce="300">
        </ion-searchbar>
        <ion-button fill="clear" size="small" (click)="onSearchClicked()">
          <ion-icon name="close-outline"></ion-icon>
        </ion-button>
      </div>
    </div>

    <!-- Inventory Overview Section -->
    <div class="inventory-overview">
      <div class="inventory-header">
        <span class="inventory-title">Inventory overview</span>
        <span class="auto-hide-label">Auto-hide sold out</span>
      </div>
      
      <div class="inventory-stats">
        <div class="stat-item">
          <div class="stat-label">Active items</div>
          <div class="stat-value">{{ getActiveItemsCount() }}</div>
        </div>
        <div class="stat-divider"></div>
        <div class="stat-item">
          <div class="stat-label">Categories</div>
          <div class="stat-value">{{ getCategoriesCount() }}</div>
        </div>
      </div>

      <!-- Categories Filter -->
      <div class="categories-chips">
        <div class="chip active">All</div>
        <div class="chip" *ngFor="let category of categories">{{ category }}</div>
      </div>
    </div>

    <!-- Products Count -->
    <div class="products-count">
      <span>Showing {{ getFilteredProducts().length }}</span>
    </div>
  </div>

  <!-- Products List -->
  <div class="products-list">
    <div class="product-row" *ngFor="let product of getFilteredProducts()" [class.sold-out]="!product.inStock">
      <!-- Product Image -->
      <div class="product-image-col">
        <img [src]="product.image" [alt]="product.name" class="product-img">
      </div>

      <!-- Product Info Column -->
      <div class="product-info-col">
        <!-- Product Name and Category -->
        <div class="product-name-section">
          <h3 class="product-name">{{ product.name }}</h3>
          <p class="product-category">{{ product.category }}</p>
        </div>

        <!-- Price -->
        <div class="product-price-section">
          <p class="product-price">â‚¹{{ product.price }}</p>
        </div>
      </div>

      <!-- Product Actions Column -->
      <div class="product-actions-col">
        <!-- Sale Badge -->
        <ion-badge *ngIf="product.hasSale" color="danger" class="sale-badge">Sale</ion-badge>

        <!-- Action Buttons Grid -->
        <div class="action-buttons">
          <ion-button fill="clear" size="small" class="action-btn edit-btn" (click)="editProduct(product.id)" title="Edit">
            <ion-icon name="create-outline"></ion-icon>
          </ion-button>
          <ion-button fill="clear" size="small" class="action-btn archive-btn" (click)="archiveProduct(product.id)" *ngIf="!product.hasSale" title="Archive">
            <ion-icon name="archive-outline"></ion-icon>
          </ion-button>
          <ion-button fill="clear" size="small" class="action-btn hide-btn" (click)="hideProduct(product.id)" title="Hide">
            <ion-icon name="eye-off-outline"></ion-icon>
          </ion-button>
        </div>

        <!-- Auto-hide Badge for sold out -->
        <div class="auto-hide-badge" *ngIf="!product.inStock">
          Auto-hide
        </div>
      </div>
    </div>
  </div>
</ion-content>
